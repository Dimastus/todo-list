let ul=document.getElementsByTagName("ul")[0],div=document.querySelector("div.filters"),countElems=div.querySelector("span");function addItem(e,t){e.append(t)}function createItem(e="div",t,l){let a=document.createElement(e);return t&&Array.isArray(t)&&t.forEach(([e,t])=>{a.setAttribute(e,t)}),a.innerHTML=l||"",a}function isChildren(){ul.children.length?div.style.display="block":div.style.display="none"}function filterChildren(e){for(let t=0,l=ul.children.length;t<l;t++){const l=ul.children[t];l.classList.contains(e)?l.style.display="flex":l.style.display="all"===e?"flex":"none"}}function countElements(){let e=0;for(let t=0,l=ul.children.length;t<l;t++){const l=ul.children[t];"flex"===getComputedStyle(l).display&&e++}countElems.innerHTML=`${e}/${ul.children.length} elements`}function addItemLS(e){let{key:t}=e;localStorage.setItem("item-"+t,JSON.stringify(e))}function readLS(){for(let e=0,t=localStorage.length;e<t;e++){let t=localStorage.getItem("item-"+(e+1));if(t){let{key:e,tagName:l,className:a,innerHTML:n}=JSON.parse(t),i=createItem(l,[["class",a],["data-ls",e]]),r=createItem("input",[["type","checkbox"]]),c=createItem("span","",n),s=createItem("button","","X");"completed"===a&&(r.checked=!0),addItem(i,r),addItem(i,c),addItem(i,s),addItem(ul,i)}}}readLS(),countElements(),document.addEventListener("click",()=>{isChildren()}),document.addEventListener("keypress",()=>{isChildren()}),enter.addEventListener("keypress",(function(e){if("Enter"===e.key){e.preventDefault();let t=createItem("li",[["class","active"],["data-ls",""+(ul.children[ul.children.length - 1] ? +ul.children[ul.children.length - 1].dataset.ls + 1 : 1)]]),l=createItem("input",[["type","checkbox"]]),a=createItem("span","",this.value),n=createItem("button","","X"),i={key:ul.children[ul.children.length - 1] ? +ul.children[ul.children.length - 1].dataset.ls + 1 : 1,tagName:t.tagName.toLowerCase(),className:t.className,innerHTML:a.innerHTML};""!==this.value&&(addItem(t,l),addItem(t,a),addItem(t,n),addItem(ul,t),addItemLS(i)),this.value="",countElements()}})),ul.addEventListener("click",e=>{let t=e.target,l=e.target.parentElement;if("input"===t.tagName.toLowerCase()&&"checkbox"===t.getAttribute("type")){let e=l.dataset.ls;l.classList.toggle("completed"),l.classList.toggle("active");let{key:t,tagName:a,className:n,innerHTML:i}=JSON.parse(localStorage.getItem("item-"+e));n=l.className,localStorage.removeItem("item-"+e),localStorage.setItem("item-"+e,JSON.stringify({key:t,tagName:a,className:n,innerHTML:i}))}"button"===t.tagName.toLowerCase()&&confirm("Do you really want to remove this row?")&&(l.remove(),countElements(),localStorage.removeItem("item-"+l.dataset.ls))}),div.addEventListener("click",e=>{switch(e.target.value){case"all":filterChildren("all");break;case"active":filterChildren("active");break;case"completed":filterChildren("completed");break;default:console.log("nothing")}countElements()});